![Basic Architecture](./assets/basic_architecture.png)

Keplr allows users to use multiple private keys from one mnemonic for multiple chains which support BIP44. Mnemonic is stored in browser’s local storage with encrypted. Encryption algorithm is similar to algorithm of Ethereum’s keystore. The main difference is that Ethereum’s keystore encrypts private key but Keplr encrypts the mnemonic key.

Keplr has a main background process and it includes key ring that manages mnemonic and private key or signing transaction for each chain. Keplr extension injects the wallet provider for each web page and web pages can interact with keplr extension by using this injected wallet provider. But, for security and privacy protection, it is needed to interact with keplr extension that each web page should request the permission with origin and chain id and user can approve or reject this request in keplr extension. If they don’t have the permission, they can’t interact with keplr extension except for requesting permission. 

If web page have the permission to specific chain id, they can interact with keplr extension within the same origin that have been approved by user. Before sending transaction, they can get the user’s public key and address from extension. And, they can request the signature for transaction and user can approve or reject this request explicitly. Because transaction structure can be different per each chain made from Cosmos-SDK, keplr has one more optional request step for setting fee. Users may want to set fee manually even though developers suggest the prefered fee setting. In this case, developers request the fee setting to keplr extension in prior to request signature, and user can set parameters related to fee (gas, fee amount...) and finally developers make the transaction by using this parameters and request signature. And keplr extension validates that the fee is set equal to previously submitted fee if transaction structure is already known structure like cosmos-sdk/StdTx. And if transaction structure is unknown, keplr extension warns the users to check the fee before approving the signature. 
